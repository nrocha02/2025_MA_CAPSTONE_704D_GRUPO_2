{% extends "ventas/ventas_base.html" %}
{% load static %}
{% load image_tags %}

{% block title %}Arena para Gatos - Cordillera Pets{% endblock %}

{% block top_bar_message %}Despachos gratis por compras sobre $50.000 dentro de Santiago{% endblock %}

{% block content %}

<!----- Migas de pan -
<div class="container mt-3">
  <small><a href="/">Home</a> / {{ categoria }}</small>
</div



 Imagen destacada estilo banner largo -->
    <div style="width: 100%; max-width: 1200px; margin: 20px auto; border-radius: 15px; overflow: hidden; box-shadow: 0 8px 20px rgba(0,0,0,0.3);">
        <img src="{% static 'blog/images/sanitaria/sanitaria.png' %}"
             alt="Promoción"
             style="width: 100%; height: 400px; object-fit: cover; display: block;">
    </div>



<!-- Subcategorías -->
    <div class="container text-center my-5">
        <h4>¡Lo mejor para tu mascota {{ categoria|lower }}!</h4>
        <div class="row justify-content-center mt-4">
        </div>
    </div>


    </div>

<!--Productos de arena sanitaria desde la base de datos-->
    <section id="portafolio" class="portfolio section-padding">
        <div class="container">
            <div class="row">
                <div class="col-md-12">
                    <div class="section-header text-center pb-5">
                        <h4>{{ categoria }} ({{ productos|length }} productos)</h4>
                    </div>
                </div>
            </div>
            <div class="row">
                {% for producto in productos %}
                    <div class="col-12 col-md-6 col-lg-3 mb-4">
                        <div class="card text-center bg-white pb-2 h-100">
                            <div class="card-body text-dark">
                                <div class="img-area mb-4">
                                    {% if producto.imagen_url %}
                                        <img src="{% product_image_url producto.imagen_url %}" alt="{{ producto.nombre }}" width="200" height="200" style="object-fit: cover;">
                                    {% else %}
                                        <div class="d-flex align-items-center justify-content-center bg-light" style="width: 200px; height: 200px; margin: 0 auto;">
                                            <span class="text-muted">Sin imagen</span>
                                        </div>
                                    {% endif %}
                                </div>
                                <h5 class="card-title">{{ producto.nombre }}</h5>
                                <p class="text-muted small">{{ producto.marca.nombre|default:"Sin marca" }}</p>
                                <p class="lead" style="font-size: small;">
                                    {{ producto.descripcion|truncatewords:20|default:"Descripción no disponible" }}
                                    <br><br>
                                    <strong>SKU:</strong> {{ producto.sku }}<br>
                                    <strong>Stock:</strong> {{ producto.stock }} unidades<br>
                                    <strong>Precio: ${{ producto.precio|floatformat:0 }}</strong>
                                </p>
                                <div class="mt-auto">
                                    <a href="{% url 'producto_detalle' producto.producto_id %}" class="btn btn-outline-primary btn-sm me-2">Ver detalle</a>
                                    {% if producto.stock > 0 %}
                                        <button type="button" class="btn btn-success btn-sm" onclick="agregarAlCarrito({{ producto.producto_id }})">Añadir al Carrito</button>
                                    {% else %}
                                        <button type="button" class="btn btn-secondary btn-sm" disabled>Sin stock</button>
                                    {% endif %}
                                </div>
                            </div>
                        </div>
                    </div>
                {% empty %}
                    <div class="col-12 text-center">
                        <div class="alert alert-info">
                            <h5>No hay productos disponibles</h5>
                            <p>No se encontraron productos de {{ categoria|lower }} en este momento.</p>
                            <a href="{% url 'catalogo' %}" class="btn btn-primary">Ver todos los productos</a>
                        </div>
                    </div>
                {% endfor %}
            </div>
        </div>
    </section>

<!-- Script para agregar al carrito -->
    <script>
        function agregarAlCarrito(productoId) {
            window.location.href = "{% url 'carrito' %}?add=" + productoId;
        }
    </script>
    <div class="col-12 col-md-8 col-lg-3">
        <div class="card  text-center bg-white pb-2">
            <div class="card-body text-dark">
                <div class="img-area mb-4">
                    <img src="{% static 'blog/images/sanitaria/vender.png' %}" alt=""  width="200" height="200">
                </div>
                <h3 class="card-title">VanCat Arena Sanitaria Aglutinante Aroma Lavanda 10Kg</h3>
                <p class="lead" style="font-size: medium" >Esta elaborada con Bentonita Natural con un gran capacidad
                    de absorción, la arena es capaz de absorver hasta el 30% de liquido.  <br>
                    <br>
                    Precio: 12.500<br>
                </p>
                <button type="button" class="btn btn-secondary">Añadir al Carrito</button>
            </div>
        </div>
    </div>
    <div class="col-12 col-md-8 col-lg-3">
        <div class="card  text-center bg-white pb-2">
            <div class="card-body text-dark">
                <div class="img-area mb-4">
                    <img src="{% static 'blog/images/sanitaria/Grey.png' %}" alt="" width="200" height="200">
                </div>
                <h3 class="card-title">VanCat Arena para Gatos Alto Control de Olores 10Kg</h3>
                <p class="lead" style="font-size: medium">La ingeniosa distribución del gránulo, desde grueso hasta fino,
                    eliminando de raíz problemas comunes como el lodo y malos olores.<br>
                    <br>
                    Precio: $16.190<br>
                </p>
                <button type="button" class="btn btn-secondary">Añadir al carrito</button>
            </div>
        </div>
    </div>
    <div class="col-12 col-md-8 col-lg-3">
        <div class="card  text-center bg-white pb-2">
            <div class="card-body text-dark">
                <div class="img-area mb-4">
                    <img src="{% static 'blog/images/sanitaria/Soap.png' %}" alt="" width="200" height="200">
                </div>
                <h3 class="card-title">VanCat Arena Sanitaria Aroma Jabón de marsella 10Kg</h3>
                <p class="lead" style="font-size: medium">Gracias a su extraordinaria capacidad de absorción de líquidos,
                    proporciona un uso más prolongado en comparación de otras arenas. <br>
                    <br>
                    Precio: $16.190<br>
                </p>
                <button type="button" class="btn btn-secondary">Añadir al carrito</button>
            </div>
        </div>
    </div>
    <div class="col-12 col-md-8 col-lg-3">
        <div class="card  text-center bg-white pb-2">
            <div class="card-body text-dark">
                <div class="img-area mb-4">
                    <img src="{% static 'blog/images/sanitaria/Orange.png' %}" alt="" width="200" height="200">
                </div>
                <h3 class="card-title">VanCat Arena Sanitaria Aroma Naranja 10Kg</h3>
                <p class="lead" style="font-size: medium">La distribución del granulo de grueso a fino de VanCat permite que el líquido
                    de la superficie pase a la parte inferior, elimina la adherencia a las patas. <br>
                    <br>
                    Precio: 18.000 <br>
                </p>
                <button type="button" class="btn btn-secondary">Añadir al carrito</button>
            </div>
        </div>
    </div>
    <div class="col-12 col-md-8 col-lg-3">
        <div class="card  text-center bg-white pb-2">
            <div class="card-body text-dark">
                <div class="img-area mb-4">
                    <img src="{% static 'blog/images/sanitaria/Vanilla.png' %}" alt="" width="200" height="200">
                </div>
                <h3 class="card-title">VanCat Arena Sanitaria Aroma Vainilla 10Kg</h3>
                <p class="lead " style="font-size: medium">Gracias a su extraordinaria capacidad de absorción de líquidos,
                    proporciona un uso más prolongado en comparación de otras arenas. <br>
                    <br>
                    Precio: $16.000<br>
                </p>
                <button type="button" class="btn btn-secondary">Añadir al carrito</button>
            </div>
        </div>
    </div>
    <div class="col-12 col-md-8 col-lg-3">
        <div class="card  text-center bg-white pb-2">
            <div class="card-body text-dark">
                <div class="img-area mb-4">
                    <img src="{% static 'blog/images/sanitaria/VanCat2.png' %}" alt="" width="200" height="200">
                </div>
                <h3 class="card-title">VanCat Arena Sanitaria Aroma Natural 20Kg</h3>
                <p class="lead" style="font-size: medium">Esta elaborada con Bentonita Natural con un gran capacidad
                    de absorción, la arena es capaz de absorver hasta el 30% de liquido.<br>
                    <br>
                    Precio: $17000 <br>
                </p>
                <button type="button" class="btn btn-secondary">Añadir al carrito</button>
            </div>
        </div>
    </div>
    </div>
    </div>
    </section>



<!-- Productos recomendados -->
    <div class="container my-5">
        <h4 class="fw-bold">No te lo pierdas!</h4>
        <div id="carouselProductos" class="carousel slide" data-bs-ride="carousel">
            <div class="carousel-inner">

                {% for producto in productos %}
                    <div class="carousel-item {% if forloop.first %}active{% endif %}">
                        <div class="row justify-content-center">
                            <div class="col-6 col-md-3">
                                <div class="card shadow-sm h-100">
                                    <img src="{{ producto.imagen.url }}" class="card-img-top" alt="{{ producto.nombre }}">
                                    <div class="card-body text-center">
                                        <h6 class="card-title">{{ producto.nombre }}</h6>
                                        <p class="text-primary fw-bold">${{ producto.precio }}</p>
                                        <a href="{% url 'carrito' %}?add={{ producto.id }}" class="btn btn-sm btn-success">Agregar</a>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                {% endfor %}

            </div>
            <button class="carousel-control-prev" type="button" data-bs-target="#carouselProductos" data-bs-slide="prev">
                <span class="carousel-control-prev-icon"></span>
            </button>
            <button class="carousel-control-next" type="button" data-bs-target="#carouselProductos" data-bs-slide="next">
                <span class="carousel-control-next-icon"></span>
            </button>
        </div>
    </div>

{% endblock %}

{% block extra_js %}
    <script>
        function agregarAlCarrito(productoId) {
            window.location.href = "{% url 'carrito' %}?add=" + productoId;
        }
    </script>
{% endblock %}
